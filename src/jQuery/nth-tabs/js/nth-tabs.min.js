(function(a){a.fn.nthTabs=function(j){var g=this;var f={allowClose:true,active:true,location:true,fadeIn:true,rollWidth:g.width()-120};var e=a.extend({},f,j);var h=0;var i='<div class="page-tabs"><a href="#" class="roll-nav roll-nav-left"><span class="fa fa-angle-double-left"></span></a><div class="content-tabs"><div class="content-tabs-container"><ul class="nav nav-tabs"></ul></div></div><a href="#" class="roll-nav roll-nav-right"><span class="fa fa-angle-double-right"></span></a><div class="dropdown roll-nav right-nav-list"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="tab-down"></span></a><ul class="dropdown-menu"><li><a href="#" class="tab-location">\u5b9a\u4f4d\u5f53\u524d\u9009\u9879\u5361</a></li><li><a href="#" class="tab-close-current">\u5173\u95ed\u5f53\u524d\u9009\u9879\u5361</a></li><li role="separator" class="divider"></li><li><a href="#" class="tab-close-other">\u5173\u95ed\u5176\u4ed6\u9009\u9879\u5361</a></li><li><a href="#" class="tab-close-all">\u5173\u95ed\u5168\u90e8\u9009\u9879\u5361</a></li><li class="divider"></li><li class="scrollbar-outer tab-list-scrollbar"><div class="tab-list-container"><ul class="tab-list"></ul></div></li></ul></div></div><div class="tab-content"></div>';var d=function(){g.html(i);b.onWindowsResize().onTabClose().onTabRollLeft().onTabRollRight().onTabList().onTabCloseOpt().onTabCloseAll().onTabCloseOther().onLocationTab();return c};var c={getAllTabWidth:function(){var k=0;g.find(".nav-tabs li").each(function(){k+=parseFloat(a(this).width())});return k},getMarginStep:function(){return e.rollWidth/2},getActiveId:function(){return g.find('li[class="active"]').find("a").attr("href").replace("#","")},getTabList:function(){var k=[];g.find(".nav-tabs li a").each(function(){k.push({id:a(this).attr("href"),title:a(this).children("span").html()})});return k},addTab:function(o){var p=[];var r=o.active==undefined?e.active:o.active;var m=o.allowClose==undefined?e.allowClose:o.allowClose;var l=o.location==undefined?e.location:o.location;var k=o.fadeIn==undefined?e.fadeIn:o.fadeIn;var n=o.url==undefined?"":o.url;p.push('<li title="'+o.title+'">');p.push('<a href="#'+o.id+'" data-toggle="tab">');p.push("<span>"+o.title+"</span>");p.push("</a>");m?p.push('<i class="icon nth-icon-close-mini tab-close"></i>'):"";p.push("</li>");g.find(".nav-tabs").append(p.join(""));var q=[];q.push('<div class="tab-pane '+(k?"animation-fade":"")+'" id="'+o.id+'">');if(n.length>0){q.push('<iframe src="'+o.url+'" frameborder="0" name="iframe-'+h+'" class="nth-tabs-frame"></iframe>');h++}else{q.push('<div class="nth-tabs-content">'+o.content+"</div>")}q.push("</div>");g.find(".tab-content").append(q.join(""));r&&this.setActTab(o.id);l&&this.locationTab(o.id);return this},addTabs:function(l){for(var k in l){this.addTab(l[k])}return this},locationTab:function(m){m=m==undefined?c.getActiveId():m;m=m.indexOf("#")>-1?m:"#"+m;var n=g.find("[href='"+m+"']");var l=0;n.parent().prevAll().each(function(){l+=a(this).width()});var k=n.parent().parent().parent();if(l<=e.rollWidth){margin_left_total=40}else{margin_left_total=40-Math.floor(l/e.rollWidth)*e.rollWidth}k.css("margin-left",margin_left_total);return this},delTab:function(l){l=l==undefined?c.getActiveId():l;l=l.indexOf("#")>-1?l:"#"+l;var m=g.find("[href='"+l+"']");if(m.parent().attr("class")=="active"){var k=m.parent().next();var n=a(l).next();if(k.length<1){k=m.parent().prev();n=a(l).prev()}k.addClass("active");n.addClass("active")}m.parent().remove();a(l).remove();return this},delOtherTab:function(){g.find(".nav-tabs li").not('[class="active"]').remove();g.find(".tab-content div.tab-pane").not('[class$="active"]').remove();g.find(".content-tabs-container").css("margin-left",40);return this},delAllTab:function(){g.find(".nav-tabs li").remove();g.find(".tab-content div").remove();return this},setActTab:function(k){k=k==undefined?c.getActiveId():k;k=k.indexOf("#")>-1?k:"#"+k;g.find(".active").removeClass("active");g.find("[href='"+k+"']").parent().addClass("active");g.find(k).addClass("active");return this},toggleTab:function(k){this.setActTab(k).locationTab(k);return this}};var b={onWindowsResize:function(){a(window).resize(function(){e.rollWidth=g.width()-120});return this},onLocationTab:function(){g.on("click",".tab-location",function(){c.locationTab()});return this},onTabClose:function(){g.on("click",".tab-close",function(){var n=a(this).parent().find("a").attr("href");var q=g.find("[href='"+n+"']");if(q.parent().next().length==0){var l=0;q.parent().prevAll().each(function(){l+=a(this).width()});var p=q.parent().width();var o=40;var k=q.parent().parent().parent();if(l>e.rollWidth){var m=k.css("marginLeft").replace("px","");o=parseFloat(m)+p+40}k.css("margin-left",o)}c.delTab(n)});return this},onTabCloseOpt:function(){g.on("click",".tab-close-current",function(){c.delTab()});return this},onTabCloseOther:function(){g.on("click",".tab-close-other",function(){c.delOtherTab()});return this},onTabCloseAll:function(){g.on("click",".tab-close-all",function(){c.delAllTab()});return this},onTabRollLeft:function(){g.on("click",".roll-nav-left",function(){var k=a(this).parent().find(".content-tabs-container");var m;if(c.getAllTabWidth()<=e.rollWidth){m=40}else{var l=k.css("marginLeft").replace("px","");m=parseFloat(l)+c.getMarginStep()+40}k.css("margin-left",m>40?40:m)});return this},onTabRollRight:function(){g.on("click",".roll-nav-right",function(){if(c.getAllTabWidth()<=e.rollWidth){return false}var k=a(this).parent().find(".content-tabs-container");var l=k.css("marginLeft").replace("px","");var m=parseFloat(l)-c.getMarginStep();if(c.getAllTabWidth()-Math.abs(l)<=e.rollWidth){return false}k.css("margin-left",m)});return this},onTabList:function(){g.on("click",".right-nav-list",function(){var k=c.getTabList();var l=[];a.each(k,function(m,n){l.push('<li class="toggle-tab" data-id="'+n.id+'">'+n.title+"</li>")});g.find(".tab-list").html(l.join(""))});g.find(".tab-list-scrollbar").scrollbar();this.onTabListToggle();return this},onTabListToggle:function(){g.on("click",".toggle-tab",function(){var k=a(this).data("id");c.setActTab(k).locationTab(k)});return this}};return d()}})(jQuery);
